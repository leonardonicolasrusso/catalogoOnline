<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Cat√°logo de Controles</title>
  <style>
    :root{
      --bg:#f5f6f8; --ink:#111; --muted:#6b7280; --card:#fff;
      --radius:14px; --shadow:0 6px 18px rgba(0,0,0,.08);
      --accent:#0ea5e9;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;background:var(--bg);color:var(--ink)}

    header{
      position:sticky;top:0;z-index:5;
      background:rgba(255,255,255,.7);backdrop-filter:blur(6px);
      border-bottom:1px solid #e5e7eb;
      padding:22px 12px 12px;
      text-align:center;
    }
    h1{margin:0;font-size:clamp(22px,3.5vw,32px)}
    .sub{color:var(--muted);font-size:14px;margin-top:6px}

    /* CATEGOR√çAS (segmented) */
    .cats{
      margin:10px auto 6px;display:flex;gap:8px;justify-content:center;flex-wrap:wrap;
      padding:0 12px;
    }
    .cat-btn{
      appearance:none;background:#fff;border:1px solid #e5e7eb;color:#111;
      padding:8px 12px;border-radius:999px;font-weight:700;cursor:pointer;
    }
    .cat-btn.active{ background:var(--accent); color:#fff; border-color:transparent }

    main{max-width:1400px;margin:auto;padding:18px}

    /* GRID */
    .grid{
      display:grid;
      grid-template-columns:repeat(auto-fill, minmax(200px,1fr));
      gap:18px;
    }
    @media (max-width: 600px) {
      .grid { grid-template-columns: repeat(2, 1fr); gap: 12px; }
    }
    .card{
      background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);
      padding:12px;text-align:center;cursor:pointer;transition:transform .15s ease
    }
    .card:hover{transform:translateY(-3px)}
    .card img{
      width:100%;
      aspect-ratio:1/1;
      object-fit:contain;
      background:#f1f3f5;
      border-radius:12px;
    }
    .name{margin-top:8px;font-weight:700;text-transform:uppercase;font-size:14px}

    /* DETAIL */
    .detail{max-width:900px;margin:18px auto;display:none}
    .detail.visible{display:block}
    .crumbs{margin-bottom:14px}
    .crumbs a{color:#2563eb;text-decoration:none}
    .detail-card{
      background:#fff;border-radius:18px;box-shadow:var(--shadow);
      padding:20px;display:grid;gap:20px;grid-template-columns:1.1fr 1fr;
    }
    .detail-img{
      width:100%;
      aspect-ratio:1/1;
      object-fit:contain;
      background:#f1f3f5;border-radius:16px;
      cursor: zoom-in;
    }
    .detail h2{margin:0 0 6px 0;text-transform:uppercase}
    .muted{color:var(--muted)}
    .row{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    .btn{appearance:none;border:1px solid #e5e7eb;background:#fff;padding:9px 12px;border-radius:12px;font-weight:600;cursor:pointer}
    .btn.primary{background:var(--accent);color:#fff;border-color:transparent}
    .tag{font-size:13px;color:#059669;display:none}

    @media (max-width: 860px){
      .detail-card{grid-template-columns:1fr}
    }

    /* MODAL ZOOM */
    #zoomModal{
      display:none; position:fixed; inset:0;
      background:rgba(0,0,0,.85);
      justify-content:center; align-items:center; flex-direction:column;
      z-index:2000; padding:20px;
    }
    #zoomModal img{ max-width:90%; max-height:80%; border-radius:10px; object-fit:contain; background:#fff; }
    #zoomModal button{ margin-top:20px; background:#fff; color:#111; border:0; padding:8px 16px; font-size:16px; border-radius:8px; cursor:pointer; }
    #zoomModal button:hover{ background:#eaeaea }

    /* Sentinel (infinite scroll) */
    #sentinel{ height:1px; }
    .loading-note{ text-align:center; color:var(--muted); font-size:13px; margin-top:10px; }
  </style>
</head>
<body>
  <header>
    <h1>CAT√ÅLOGO DE CONTROLES</h1>
    <div class="sub">Usa las categor√≠as para filtrar. Toca un control para verlo.</div>

    <!-- BOTONES DE CATEGOR√çA -->
    <div class="cats" id="catBar">
      <button class="cat-btn active" data-cat="lcd">LCD / SMART TV</button>
      <button class="cat-btn" data-cat="box">TV BOX</button>
      <button class="cat-btn" data-cat="universal">UNIVERSAL</button>
      <button class="cat-btn" data-cat="aire">AIRE ACOND.</button>
    </div>
  </header>

  <main>
    <!-- GRID -->
    <section id="grid" class="grid" aria-live="polite"></section>
    <div id="sentinel" aria-hidden="true"></div>
    <div id="loadingNote" class="loading-note" style="display:none;">Cargando m√°s‚Ä¶</div>

    <!-- DETAIL -->
    <section id="detail" class="detail">
      <div class="crumbs"><a href="#" id="backLink">‚Üê Volver al cat√°logo</a></div>
      <div class="detail-card">
        <img id="detailImg" class="detail-img" alt="Control remoto"/>
        <div>
          <h2 id="detailName">LCD 000</h2>
          <p id="zoomHint" class="muted" style="margin-top:4px;">Haz clic en la imagen para hacer zoom üîç</p>
          <div class="row">
            <a id="openLink" style="display:none" class="btn" target="_blank" rel="noopener">Abrir este link</a>
            <button id="shareBtn" class="btn primary">Compartir</button>
            <span id="shared" class="tag">¬°Listo para enviar!</span>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- MODAL ZOOM -->
  <div id="zoomModal" role="dialog" aria-modal="true" aria-label="Zoom de imagen">
    <img id="zoomImg" src="" alt="Zoom control" />
    <button id="zoomClose">‚úñ Cerrar</button>
  </div>

  <script>
    /* ================== CONFIG CATEGOR√çAS ==================
      Edit√° los arrays con los nombres de archivo (sin extensi√≥n).
      Estructura de carpetas:
        img/
          lcd/        -> LCD / SMART TV
          box/        -> TV BOX
          universal/  -> UNIVERSAL
          aire/       -> AIRE ACOND.
      Las im√°genes se buscan con la extensi√≥n definida en EXT.
    ======================================================== */
    const EXT = '.png';

    const CATEGORIES = {
      lcd: {
        label: 'LCD / SMART TV',
        path: 'img/lcd/',
        // üëâ IDs de LCD (los que ya ven√≠as usando)
        items: [
          132,133,401,403,405,406,407,408,409,410,411,412,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,"448","448TH",449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,"467JV",468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,"498","498TH","498TH2",499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,"553P",554,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,638,639,640,641,642,643,644,645,646,649,654,656,657,658
        ],
        displayName: id => `LCD ${id}`
      },
      box: {
        label: 'TV BOX',
        path: 'img/box/',
        // üëâ Agreg√° aqu√≠ los nombres de archivo (sin extensi√≥n) de tus 2 box.
        // Ejemplos de prueba (c√°mbialos por los tuyos):
        items: ['TvBox1', 'TvBox2'],
        displayName: id => String(id)
      },
      universal: {
        label: 'UNIVERSAL',
        path: 'img/universal/',
        // üëâ √önica imagen universal (coloc√° aqu√≠ el nombre sin extensi√≥n)
        items: ['aireUniversal'], // reemplaz√° por tu nombre real
        displayName: id => String(id)
      },
      aire: {
        label: 'AIRE ACOND.',
        path: 'img/aire/',
        // üëâ Agreg√° aqu√≠ tus im√°genes de aire (sin extensi√≥n). Ejemplo:
        items: [800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,889,890,891,892,893,895,900]
, // reemplaz√° por los que tengas
        displayName: id => `AR ${id}`
      }
    };

    /* ================== REFERENCIAS DOM ================== */
    const gridEl    = document.getElementById('grid');
    const detailEl  = document.getElementById('detail');
    const dImg      = document.getElementById('detailImg');
    const dName     = document.getElementById('detailName');
    const openLink  = document.getElementById('openLink');
    const shareBtn  = document.getElementById('shareBtn');
    const shared    = document.getElementById('shared');
    const backLink  = document.getElementById('backLink');

    const sentinel   = document.getElementById('sentinel');
    const loadingNote= document.getElementById('loadingNote');

    const catBar     = document.getElementById('catBar');

    // Modal Zoom
    const zoomModal = document.getElementById('zoomModal');
    const zoomImg   = document.getElementById('zoomImg');
    const zoomClose = document.getElementById('zoomClose');

    /* ================== ESTADO ================== */
    let currentCatKey = 'lcd';
    let SOURCE_LIST   = [];
    let PAGE_SIZE     = 40;
    let page = 0, loading = false, observer = null;

    /* ================== UTILIDADES ================== */
    function srcFor(id){
      const cat = CATEGORIES[currentCatKey];
      return `${cat.path}${id}${EXT}`;
    }
    function nameFor(id){
      return CATEGORIES[currentCatKey].displayName(id);
    }
    function setActiveCatButton(){
      catBar.querySelectorAll('.cat-btn').forEach(b=>{
        b.classList.toggle('active', b.dataset.cat === currentCatKey);
      });
    }
    function writeCatToURL(){
      const url = new URL(location.href);
      url.searchParams.set('cat', currentCatKey);
      history.replaceState({}, '', url);
    }
    function readCatFromURL(){
      const url = new URL(location.href);
      const c = url.searchParams.get('cat');
      if (c && CATEGORIES[c]) currentCatKey = c;
    }

    /* ================== RENDER GRID (infinite) ================== */
    function createCard(id){
      const card = document.createElement('article');
      card.className = 'card';
      const display = nameFor(id);
      const src = srcFor(id);
      card.innerHTML = `
        <img src="${src}" alt="${display}" loading="lazy">
        <div class="name">${display}</div>
      `;
      card.addEventListener('click', () => openDetail(id));
      return card;
    }

    function appendBatch(){
      if (loading) return;
      loading = true; loadingNote.style.display = 'block';

      const start = page * PAGE_SIZE;
      const end   = Math.min(start + PAGE_SIZE, SOURCE_LIST.length);

      if (start >= SOURCE_LIST.length) {
        loadingNote.style.display = 'none';
        disconnectObserver();
        loading = false;
        return;
      }
      for (let i = start; i < end; i++){
        gridEl.appendChild(createCard(SOURCE_LIST[i]));
      }
      page++;
      loading = false; loadingNote.style.display = 'none';

      if (page * PAGE_SIZE >= SOURCE_LIST.length){
        disconnectObserver();
      }
      fillViewportIfNeeded();
    }

    function fillViewportIfNeeded(){
      if (detailEl.classList.contains('visible')) return;
      if (document.documentElement.scrollHeight <= window.innerHeight + 50) {
        requestAnimationFrame(()=> appendBatch());
      }
    }

    function disconnectObserver(){ if (observer){ observer.disconnect(); observer=null; } }
    function setupObserver(){
      disconnectObserver();
      observer = new IntersectionObserver((entries)=>{
        const entry = entries[0];
        if (entry.isIntersecting && !detailEl.classList.contains('visible')){
          appendBatch();
        }
      }, { root:null, rootMargin:'800px 0px', threshold:0 });
      observer.observe(sentinel);
    }

    function renderGridInitial(){
      gridEl.innerHTML = '';
      page = 0; loading = false;
      appendBatch(); // primer lote
      appendBatch(); // segundo lote para llenar
      setupObserver();
      fillViewportIfNeeded();
    }

    /* ================== CAMBIO DE CATEGOR√çA ================== */
    function setCategory(catKey){
      if (!CATEGORIES[catKey]) return;
      currentCatKey = catKey;
      SOURCE_LIST = [...CATEGORIES[currentCatKey].items];
      setActiveCatButton();
      writeCatToURL();
      // Reset de vista
      detailEl.classList.remove('visible');
      gridEl.style.display = 'grid';
      renderGridInitial();
    }

    catBar.addEventListener('click', (e)=>{
      const btn = e.target.closest('[data-cat]');
      if (!btn) return;
      const k = btn.dataset.cat;
      if (k === currentCatKey) return;
      setCategory(k);
    });

    /* ================== DETALLE ================== */
    function openDetail(id){
      const url = new URL(location.href);
      url.searchParams.set('id', id);
      url.searchParams.set('cat', currentCatKey);
      history.pushState({}, '', url);
      disconnectObserver(); // pausar infinite scroll
      showDetail(id);
    }

    function showDetail(id){
      const src  = srcFor(id);
      const name = nameFor(id);
      dImg.src = src; dImg.alt = name;
      dName.textContent = name;

      // Link directo a la imagen (para WhatsApp preview)
      const imgUrl = new URL(src, location.href).href;
      openLink.href = imgUrl;

      shareBtn.onclick = async () => {
        const shareData = { title: name, text: `Mir√° este control: ${name}`, url: imgUrl };
        try {
          if (navigator.share) {
            await navigator.share(shareData);
            shared.textContent = '‚úÖ Compartido';
          } else {
            await navigator.clipboard.writeText(imgUrl);
            shared.textContent = 'üîó Link de la imagen copiado';
          }
          shared.style.display = 'inline';
          setTimeout(()=> shared.style.display='none', 2000);
        } catch (err) { console.log('Cancelado o error al compartir:', err); }
      };

      dImg.onclick = () => abrirZoom(src);

      gridEl.style.display = 'none';
      detailEl.classList.add('visible');
      window.scrollTo({top:0, behavior:'smooth'});
    }

    // Volver
    backLink.addEventListener('click', (e)=>{
      e.preventDefault();
      const url = new URL(location.href);
      url.searchParams.delete('id');
      history.pushState({}, '', url);
      detailEl.classList.remove('visible');
      gridEl.style.display = 'grid';
      setupObserver();
      fillViewportIfNeeded();
    });

    function getId(){ return new URL(location.href).searchParams.get('id'); }
    window.addEventListener('popstate', ()=>{
      readCatFromURL(); // si cambi√≥ por el link
      setActiveCatButton();
      const id = getId();
      if(id){ showDetail(id); }
      else {
        detailEl.classList.remove('visible');
        gridEl.style.display='grid';
        setupObserver();
        fillViewportIfNeeded();
      }
    });

    window.addEventListener('resize', ()=>{
      if (!detailEl.classList.contains('visible')) fillViewportIfNeeded();
    });

    /* ================== ZOOM SIMPLE ================== */
    function abrirZoom(src){ zoomImg.src = src; zoomModal.style.display = 'flex'; }
    function cerrarZoom(){ zoomModal.style.display = 'none'; }
    zoomClose.addEventListener('click', cerrarZoom);
    zoomModal.addEventListener('click', (e)=>{ if(e.target === zoomModal) cerrarZoom(); });
    window.addEventListener('keydown', (e)=>{ if(e.key === 'Escape') cerrarZoom(); });

    /* ================== INIT ================== */
    function boot(){
      readCatFromURL();
      setActiveCatButton();
      SOURCE_LIST = [...CATEGORIES[currentCatKey].items];
      renderGridInitial();
      const startId = getId();
      if(startId){ showDetail(startId); }
    }
    boot();
  </script>
</body>
</html>
